{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryContainer = document.querySelector('#gallery-container');\n\n\nlet lightbox = new SimpleLightbox('#gallery-container a', {\n    captionsData: 'title',\n    captions: true,\n    captionDelay: 250,\n    overlay: true,\n    captionPosition: 'bottom',\n});\n\nexport function renderGallery(data) {\n    if (data.hits.length === 0) {\n        iziToast.info({\n            title: 'No results found',\n            message: 'Try a different search term.',\n        });\n        return;\n    }\n\n    const galleryHTML = data.hits.map(hit => `\n        <a href=\"${hit.largeImageURL}\" data-lightbox=\"gallery\" title=\"Tags: ${hit.tags}\">\n            <div class=\"image-wrapper\">\n                <img src=\"${hit.previewURL}\" alt=\"${hit.tags}\" title=\"\n                Tags: ${hit.tags} \n            \">\n            <div class=\"caption\">\n                <div class=\"su-caption\">\n                Likes ${hit.likes} </div>\n                <div class=\"su-caption\">\n                Views ${hit.views} </div>\n                <div class=\"su-caption\">\n                Comments ${hit.comments} </div>\n                <div class=\"su-caption\">\n                Downloads ${hit.downloads} </div>\n            </div>\n            </div>\n        </a>\n    `).join('');\n\n    galleryContainer.insertAdjacentHTML('beforeend', galleryHTML)\n\n\n    lightbox.refresh()\n}\n\nexport default class ButtonService {\n    constructor(buttonEL, hiddenClass) {\n      this.buttonEL = buttonEL;\n      this.hiddenClass = hiddenClass;\n    }\n  \n    hide() {\n      this.buttonEL.classList.add(this.hiddenClass);\n    }\n  \n    show() {\n      this.buttonEL.classList.remove(this.hiddenClass);\n    }\n  \n    disable() {\n      this.buttonEL.disabled = true;\n    }\n  \n    enable() {\n      this.buttonEL.disabled = false;\n    }\n  }","import iziToast from \"izitoast\"\n\nimport axios from 'axios';\n\nconst URL = 'https://pixabay.com/api/'\n\nconst API_KEY = '45189521-352d969f92f63c5bc874c10a6'\n\naxios.defaults.baseURL = URL\n\n\nexport async function searchByQuery(\n    { page = 1, per_page = 15, q = \"\" } = {}\n  ) {\n    try {\n    const { data } = await axios\n      .get('', {\n        params: {\n          page,\n          per_page,\n          q,\n          key: API_KEY,\n          image_type: \"photo\",\n          orientation: \"horizontal\",\n          safesearch: true\n        },\n      })\n      return data\n  } catch (error) {\n    throw new Error(`Error fetching data ${error.message}`)\n  } \n}\n\n\n\n// return fetch(`${URL}?${params}`).then((res) => {\n//     if (!res.ok) {\n//         throw new Error(res.status)\n//         iziToast.error({\n//             message: \"Sorry, there are no images matching your search query. Please try again!\"\n//         })\n//     }\n//     return res.json()\n// })\n\n// }\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { renderGallery } from \"./js/render-functions\";\n\nimport { searchByQuery } from \"./js/pixabay-api\";\n\nimport ButtonService from \"./js/render-functions\";\n\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\n\nconst loadMore = new ButtonService(loadMoreBtn, \"is-hidden\");\n\n// function showLoadMoreBtn() {\n//     loadMoreBtn.classList.remove('hidden');\n// }\n\n// function hideLoadMoreBtn() {\n//     loadMoreBtn.classList.add('hidden');\n// }\n\n// function enableLoadMoreBtn() {\n//     loadMoreBtn.disabled = false\n// }\n\n\nconst form = document.querySelector('.search-form')\n\nconst loadingIndicator = document.querySelector('.loader');\n\nconst galleryContainer = document.querySelector('#gallery-container');\n\nconst params = {\n    page: 1,\n    per_page: 15,\n    q: \"\",\n    maxPage: 0,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true\n}\n\nform.addEventListener('submit', handleSearch)\n\nfunction showLoadingIndicator() {\n    loadingIndicator.classList.remove('hidden');\n}\n\nfunction hideLoadingIndicator() {\n    loadingIndicator.classList.add('hidden');\n}\n\nloadMore.hide()\n\nasync function handleSearch(event) {\n    event.preventDefault()\n\n    const form = event.currentTarget\n    if (form) {\n    galleryContainer.innerHTML = ''\n    }\n\n    const queryValue = event.currentTarget.elements.query.value.trim().toLowerCase()\n    if (queryValue === '') {\n        iziToast.info({\n            message: 'Type something to find!'\n        })\n        return\n    } \n\n    showLoadingIndicator();\n\n    \n\n    params.page = 1\n    params.q = queryValue\n\n    try {\n        const data = await searchByQuery(params)\n\n        params.maxPage = Math.ceil(data.totalHits / params.per_page)\n\n\n        hideLoadingIndicator();\n        renderGallery(data)\n\n        if (params.maxPage > 1) {\n            loadMore.show()\n            loadMore.enable();\n            loadMoreBtn.addEventListener('click', handleLoadMore);\n        } else {\n            loadMore.hide()\n        }\n    } catch (error) {\n        iziToast.error({\n            message: `Помилка під час запиту: ${error.message} `\n        })\n    } finally {\n        if (form) {\n            form.reset();\n        }}\n    }\n\n\n    async function handleLoadMore() {\n        params.page += 1;\n\n        loadMore.hide()\n        showLoadingIndicator();\n        \n        try {\n            const data = await searchByQuery(params);\n            hideLoadingIndicator();\n            renderGallery(data, true); \n            loadMore.enable()\n            loadMore.show()\n            let card = document.querySelector('.image-wrapper')\n            let rect = card.getBoundingClientRect(); \n            window.scrollBy({\n                top: (2 *rect.height),\n                behavior: 'smooth'\n            })\n        } catch (error) {\n            iziToast.error({\n                message: `Error during the request: ${error.message}`\n            });\n        } finally {\n            if (params.page === params.maxPage) {\n                loadMore.hide();\n                loadMoreBtn.removeEventListener('click', handleLoadMore);\n                iziToast.info({message:\"We're sorry, but you've reached the end of search results.\"})\n        }\n    }}"],"names":["galleryContainer","lightbox","SimpleLightbox","renderGallery","data","iziToast","galleryHTML","hit","ButtonService","buttonEL","hiddenClass","URL","API_KEY","axios","searchByQuery","page","per_page","q","error","loadMoreBtn","loadMore","form","loadingIndicator","params","handleSearch","showLoadingIndicator","hideLoadingIndicator","event","queryValue","handleLoadMore","rect"],"mappings":"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"}